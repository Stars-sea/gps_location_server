syntax = "proto3";
package controller;

/*
 * Interfaces to controll clients
 */
service Controller {
    /*
     * Get the list of online clients
     */
    rpc GetOnlineClients(OnlineClientsRequest) returns (OnlineClientsResponse);

    /*
     * Get the list of registered clients
     */
    rpc GetRegisteredClients(RegisteredClientsRequest) returns (RegisteredClientsResponse);

    /*
     * Get the log of specific client
     */
    rpc GetClientLog(ClientLogRequest) returns (ClientLogResponse);

    /*
     * Send command to specific client, imei for null means broadcast to all clients
     */
    rpc SendCommand(SendCommandToClientRequest) returns (SendCommandToClientResponse);
}

message ClientInfo {
    string imei = 1;
    string iccid = 2;
    string fver = 3;
    int32 csq = 4;
}

message OnlineClientsRequest {
}

message OnlineClientsResponse {
    repeated ClientInfo clients = 1;
}

message RegisteredClientsRequest {
}

message RegisteredClientsResponse {
    repeated string imeis = 1;
}

message ClientLogRequest {
    string imei = 1;
}

message ClientLogResponse {
    optional string log = 1;
}

message SendCommandToClientRequest {
    repeated string imei = 1;
    string command = 2;
}

message SendCommandToClientResponse {
    bool success = 1;
}
